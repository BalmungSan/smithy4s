"use strict";(self.webpackChunksmithy4s=self.webpackChunksmithy4s||[]).push([[653],{3905:(e,t,o)=>{o.d(t,{Zo:()=>d,kt:()=>m});var i=o(7294);function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function s(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function a(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?s(Object(o),!0).forEach((function(t){n(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):s(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function r(e,t){if(null==e)return{};var o,i,n=function(e,t){if(null==e)return{};var o,i,n={},s=Object.keys(e);for(i=0;i<s.length;i++)o=s[i],t.indexOf(o)>=0||(n[o]=e[o]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)o=s[i],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}var l=i.createContext({}),h=function(e){var t=i.useContext(l),o=t;return e&&(o="function"==typeof e?e(t):a(a({},t),e)),o},d=function(e){var t=h(e.components);return i.createElement(l.Provider,{value:t},e.children)},c="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},u=i.forwardRef((function(e,t){var o=e.components,n=e.mdxType,s=e.originalType,l=e.parentName,d=r(e,["components","mdxType","originalType","parentName"]),c=h(o),u=n,m=c["".concat(l,".").concat(u)]||c[u]||p[u]||s;return o?i.createElement(m,a(a({ref:t},d),{},{components:o})):i.createElement(m,a({ref:t},d))}));function m(e,t){var o=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var s=o.length,a=new Array(s);a[0]=u;var r={};for(var l in t)hasOwnProperty.call(t,l)&&(r[l]=t[l]);r.originalType=e,r[c]="string"==typeof e?e:n,a[1]=r;for(var h=2;h<s;h++)a[h]=o[h];return i.createElement.apply(null,a)}return i.createElement.apply(null,o)}u.displayName="MDXCreateElement"},5990:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>s,metadata:()=>r,toc:()=>h});var i=o(7462),n=(o(7294),o(3905));const s={sidebar_label:"What is a Protocol?",title:"What is a Protocol?"},a=void 0,r={unversionedId:"protocols/definition",id:"protocols/definition",title:"What is a Protocol?",description:'Most definitions of "protocol" you read online say something like, "a set of rules defined for communication on or between computers." This is a good definition, but it also highlights the issue in understanding this topic: the definition is very broad. Because of this, the word "protocol" is used to refer to different things in different contexts. In this article, we will break down what a protocol is by looking at different types and giving examples. We will then relate things back to Smithy and Smithy4s.',source:"@site/../docs/target/jvm-2.13/mdoc/03-protocols/02-definition.md",sourceDirName:"03-protocols",slug:"/protocols/definition",permalink:"/smithy4s/docs/protocols/definition",draft:!1,editUrl:"https://github.com/disneystreaming/smithy4s/edit/main/modules/docs/src/03-protocols/02-definition.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_label:"What is a Protocol?",title:"What is a Protocol?"},sidebar:"tutorialSidebar",previous:{title:"Protocols and Smithy4s",permalink:"/smithy4s/docs/protocols/protocols"},next:{title:"AWS",permalink:"/smithy4s/docs/protocols/aws/aws"}},l={},h=[{value:"TCP/IP",id:"tcpip",level:2},{value:"Network Access Layer",id:"network-access-layer",level:4},{value:"Internet Layer",id:"internet-layer",level:4},{value:"Transport Layer",id:"transport-layer",level:4},{value:"Application Layer",id:"application-layer",level:4},{value:"Summary",id:"summary",level:4},{value:"HTTP",id:"http",level:2},{value:"Request and Response Headers",id:"request-and-response-headers",level:4},{value:"Request Methods",id:"request-methods",level:4},{value:"Response Status Codes",id:"response-status-codes",level:4},{value:"Message Body",id:"message-body",level:4},{value:"Things NOT Defined in HTTP",id:"things-not-defined-in-http",level:4},{value:"REST vs HTTP",id:"rest-vs-http",level:4},{value:"High Level Protocols",id:"high-level-protocols",level:2},{value:"alloy#simpleRestJson",id:"alloysimplerestjson",level:4},{value:"gRPC",id:"grpc",level:4},{value:"AWS Protocols",id:"aws-protocols",level:4},{value:"Protocols in Smithy",id:"protocols-in-smithy",level:2},{value:"How to Define a Protocol",id:"how-to-define-a-protocol",level:4},{value:"Conclusion",id:"conclusion",level:2}],d={toc:h},c="wrapper";function p(e){let{components:t,...o}=e;return(0,n.kt)(c,(0,i.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,'Most definitions of "protocol" you read online say something like, "a set of rules defined for communication on or between computers." This is a good definition, but it also highlights the issue in understanding this topic: the definition is very broad. Because of this, the word "protocol" is used to refer to different things in different contexts. In this article, we will break down what a protocol is by looking at different types and giving examples. We will then relate things back to Smithy and Smithy4s.'),(0,n.kt)("h2",{id:"tcpip"},"TCP/IP"),(0,n.kt)("p",null,"For starters, let's briefly address the protocols that exist at the lower layers of the internet and build from there. TCP/IP is a framework that organizes these various layers and the protocols therein. The layers are usually divided up, from lowest to highest, as follows:"),(0,n.kt)("h4",{id:"network-access-layer"},"Network Access Layer"),(0,n.kt)("p",null,"This layer is used to refer to the hardware that exists to facilitate the connections and protocols at higher levels. In other words, this layer is concerned with the physical transmission of data from one place to another."),(0,n.kt)("h4",{id:"internet-layer"},"Internet Layer"),(0,n.kt)("p",null,'This layer is mainly composed of the Internet Protocol. The Internet Protocol is what allows identifying and locating hosts on a network. The "IP" in "IPv4" and "IPv6" stands for "Internet Protocol" and those are two respective versions of that protocol.'),(0,n.kt)("h4",{id:"transport-layer"},"Transport Layer"),(0,n.kt)("p",null,"At this point live the TCP and UDP protocols. These protocols take two different approaches to the transferring of messages between two hosts."),(0,n.kt)("h4",{id:"application-layer"},"Application Layer"),(0,n.kt)("p",null,"Finally, at the top layer we have the protocol that we are all familiar with: http. Other examples of application-layer protocols are FTP, SSH, and SMTP. All of these protocols define their own procedures for interactions between host applications. Essentially, they are adding more structure to interactions that use TCP or UDP underneath. HTTP, for example, uses TCP to facilitate connections."),(0,n.kt)("h4",{id:"summary"},"Summary"),(0,n.kt)("p",null,"In summary, TCP/IP is a collection of protocols, grouped into layers, that make up the basis for interactions between computers."),(0,n.kt)("h2",{id:"http"},"HTTP"),(0,n.kt)("p",null,"Before we move on, let's make sure we have a common understanding of what HTTP actually is. HTTP stands for HyperText Transfer Protocol. As mentioned above, it builds upon TCP to send messages between two hosts. The most important thing for us to understand here is what HTTP defines and what it does not define."),(0,n.kt)("p",null,"HTTP defines semantics for communicating between host applications in a request-response model. We are all likely familiar with making an HTTP request and getting back a response. The most basic example of this is loading a web page on the internet."),(0,n.kt)("p",null,"Below is a collection of things that HTTP ",(0,n.kt)("strong",{parentName:"p"},"DOES")," define. Note that we are not going to be exhaustive in our definition of HTTP. The below is just to give an overview."),(0,n.kt)("h4",{id:"request-and-response-headers"},"Request and Response Headers"),(0,n.kt)("p",null,"HTTP defines that each request and response may have headers which contain additional information related to the request or response. These are key-value pairs where the key is case-insensitive."),(0,n.kt)("h4",{id:"request-methods"},"Request Methods"),(0,n.kt)("p",null,"Requests have methods such as ",(0,n.kt)("inlineCode",{parentName:"p"},"GET"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"PUT"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"POST"),", and ",(0,n.kt)("inlineCode",{parentName:"p"},"DELETE")," (there are currently 9 total). These methods are intended to inform the destination application what the requester wishes to do with a given resource."),(0,n.kt)("h4",{id:"response-status-codes"},"Response Status Codes"),(0,n.kt)("p",null,"Responses in HTTP come with an integer status code that represents the category of the result of the request. For example a status code between 200 and 299 is used to indicate that a request was successful."),(0,n.kt)("h4",{id:"message-body"},"Message Body"),(0,n.kt)("p",null,"HTTP defines that requests and responses each have an optional message body. This is usually where the majority of information is contained."),(0,n.kt)("h4",{id:"things-not-defined-in-http"},"Things NOT Defined in HTTP"),(0,n.kt)("p",null,"Now that we have covered the basis of what HTTP defines, it is important to call out a few things that it does not define."),(0,n.kt)("p",null,"The most major thing left out of the HTTP specification is the format for data in the body of requests and responses. As far as HTTP is concerned, these bodies are just Bytes. Defining what these bodies look like is left to higher-level protocols (as we will discuss below)."),(0,n.kt)("p",null,"HTTP also does not define what types of resources requests should be able to work with. This means requests can be used to get or modify files stored in a system, in memory state, a third party API, or anything else one could imagine."),(0,n.kt)("p",null,"Additionally, although HTTP provides some mechanisms for basic authentication, it does not define anything around authorization. Other protocols, such as OAuth 2.0 are often used with HTTP applications."),(0,n.kt)("h4",{id:"rest-vs-http"},"REST vs HTTP"),(0,n.kt)("p",null,"Here is a quick note about REST since REST is often used interchangeably with HTTP despite the fact that they are two different things. REST stands for Representational State Transfer and is an architectural pattern. It is important to realize that REST is not backed by a strict RFC or other definition for what it means like HTTP is. As such, how the pattern is implemented varies throughout the industry."),(0,n.kt)("p",null,"RESTful systems might use HTTP, but they don't need to. Similarly, HTTP services may be RESTful, but they don't need to be. The two are related, but are not the same and one does not require the other."),(0,n.kt)("h2",{id:"high-level-protocols"},"High Level Protocols"),(0,n.kt)("p",null,"Here we will discuss several \"High Level Protocols.\" There isn't an official term for these, but we will coin them as such to differentiate them from the protocols discussed above. All of the following protocols build on top of HTTP (although they don't have to), but define different semantics on top of it."),(0,n.kt)("h4",{id:"alloysimplerestjson"},"alloy#simpleRestJson"),(0,n.kt)("p",null,"The main protocol that we have defined for use in smithy4s is ",(0,n.kt)("inlineCode",{parentName:"p"},"alloy#simpleRestJson"),". This protocol uses RESTful HTTP semantics and has HTTP bodies that are encoded as JSON. Essentially, this protocol is building on the various protocols we defined above, and just adding some constraints around how they are used. There are more constraints around how the JSON is encoded and a few other things which you can read about in full in the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/disneystreaming/alloy#alloysimplerestjson"},"alloy documentation"),"."),(0,n.kt)("h4",{id:"grpc"},"gRPC"),(0,n.kt)("p",null,"gRPC is a framework for remote procedure calls. At the same time, we can consider it to be another protocol that is defined at the same level that ",(0,n.kt)("inlineCode",{parentName:"p"},"alloy#simpleRestJson")," is defined. gRPC, in its current implementation, uses HTTP version 2 under the hood. It has additional definition around what the HTTP interactions look like such as the bodies being encoded with protocol buffers (protobuf). Additionally, all gRPC messages are sent with the HTTP POST method and use a specific header to specify which remote procedure is being invoked."),(0,n.kt)("p",null,"There are quite a few other nuanced requirements for what makes up the gRPC protocol, but hopefully these few have showed you how gRPC builds on what HTTP provides to create a unique interaction pattern."),(0,n.kt)("h4",{id:"aws-protocols"},"AWS Protocols"),(0,n.kt)("p",null,"AWS themselves have defined quite a few protocols in Smithy. Examples of this range from ",(0,n.kt)("inlineCode",{parentName:"p"},"aws.protocols#restJson1")," which is very similar to ",(0,n.kt)("inlineCode",{parentName:"p"},"alloy#simpleRestJson")," to ",(0,n.kt)("inlineCode",{parentName:"p"},"aws.protocols#restXml"),". You can read more about these protocols in the ",(0,n.kt)("a",{parentName:"p",href:"https://smithy.io/2.0/aws/protocols/index.html"},"Smithy documentation"),"."),(0,n.kt)("h2",{id:"protocols-in-smithy"},"Protocols in Smithy"),(0,n.kt)("p",null,"In the context of Smithy, a protocol is a set of concrete rules that define how data modelled in Smithy gets transcribed into lower-level semantics. A protocol definition in Smithy can be accompanied by a set of trait annotations which hold further information about how the Smithy shapes are transcribed."),(0,n.kt)("p",null,"For example, the ",(0,n.kt)("inlineCode",{parentName:"p"},"alloy#simpleRestJson")," protocol relies on the ",(0,n.kt)("inlineCode",{parentName:"p"},"smithy.api#http")," trait annotation to provide information about which HTTP endpoint will map to each Smithy operation shape. Without the ",(0,n.kt)("inlineCode",{parentName:"p"},"smithy.api#http")," trait, one would not be able to specify the protocol-specific semantics of an API. This is how Smithy, the language itself, is protocol agnostic while still allowing users to define APIs which conform to various protocols."),(0,n.kt)("h4",{id:"how-to-define-a-protocol"},"How to Define a Protocol"),(0,n.kt)("p",null,"Protocols can be defined in Smithy as traits that are marked with the ",(0,n.kt)("inlineCode",{parentName:"p"},"@protocolDefinition")," ",(0,n.kt)("a",{parentName:"p",href:"https://smithy.io/2.0/spec/protocol-traits.html#protocoldefinition-trait"},"trait"),". For example, the (slightly simplified) definition of ",(0,n.kt)("inlineCode",{parentName:"p"},"alloy#simpleRestJson")," looks like:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-smithy"},'namespace alloy\n\n@protocolDefinition()\n@trait(selector: "service")\nstructure simpleRestJson {}\n')),(0,n.kt)("p",null,"This then allows you to annotate service shapes with the protocol. Although the protocol is defined in Smithy like this, the exact meaning of the protocol is defined elsewhere in documentation and more importantly in interpreters that implement the protocol (such as the interpreters that smithy4s uses to create http4s applications). Additionally, protocol definitions typically come with test cases, also ",(0,n.kt)("a",{parentName:"p",href:"https://smithy.io/2.0/additional-specs/http-protocol-compliance-tests.html"},"defined in Smithy"),", which help to define the specific semantics of the protocol."),(0,n.kt)("h2",{id:"conclusion"},"Conclusion"),(0,n.kt)("p",null,"Hopefully, this article has helped to outline what a protocol is and more specifically what layers of protocols we are building upon to create something like the ",(0,n.kt)("inlineCode",{parentName:"p"},"alloy#simpleRestJson")," protocol. If you have any more questions about protocols, especially the protocols we have defined and use in Smithy4s, don't hesitate to reach out."))}p.isMDXComponent=!0}}]);